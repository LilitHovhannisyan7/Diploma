package org.example;

import org.apache.commons.math3.linear.Array2DRowRealMatrix;
import org.apache.commons.math3.linear.MatrixUtils;
import org.apache.commons.math3.linear.RealMatrix;
import org.apache.commons.math3.linear.LUDecomposition;


import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.plot.XYPlot;
import org.jfree.data.xy.XYSeries;
import org.jfree.data.xy.XYSeriesCollection;

import javax.swing.*;
import java.awt.*;
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;

public class KalmanFilterExample {

    private XYSeries positionSeries;
    private XYSeries velocitySeries;
    private double delta_t; // Time step duration
    private RealMatrix X; // State vector: [position, velocity]
    private RealMatrix X_hat; // Predicted state vector
    private RealMatrix P; // Predicted process covariance matrix
    private RealMatrix Q; // Process noise covariance matrix
    private RealMatrix R; // Measurement noise covariance matrix
    private RealMatrix K; // Kalman gain
    private RealMatrix A; // State transition matrix
    private RealMatrix B; // Control input matrix
    private RealMatrix H; // Observation matrix
    private RealMatrix C; // Observation matrix for the output equation
    private RealMatrix Z;
    public int currentIndex; // Index to track the current acceleration value
    public double [][] measurements;

    public RealMatrix eulerX;
    public RealMatrix eulerY;
    public RealMatrix eulerZ;

    public RealMatrix newAcc;


    public KalmanFilterExample(double deltaPx, double deltaPy, double deltaPxv, double deltaPyv, double delta_x, double delta_y, double delta_xv, double delta_yv, double delta_t, double[][] H, double[][] C, RealMatrix accelerations, RealMatrix eulerX, RealMatrix eulerY, RealMatrix eulerZ) {
        this.delta_t = delta_t; // Time step duration
        if (accelerations.getColumn(0).length < 3 ) {
            throw new IllegalArgumentException("At least 3 acceleration values are required to calculate measurements.");
        }

        // Prepare an array to store measurements
        this.measurements = new double[accelerations.getColumn(0).length - 2][4];


        // Calculate accelerations with rotation matrices
        this.eulerX = eulerX;
        this.eulerY = eulerY;
        this.eulerZ = eulerZ;

        this.newAcc = getR().multiply(accelerations.transpose()).transpose();


//        System.out.println(measurements.length);

        // Calculate measurements
        for (int i = 0; i < this.measurements.length; i++) {
//            double currentAccelerationX = accelerations.getColumn(0)[i];
//            double currentAccelerationY = accelerations.getColumn(1)[i];
//            double nextAccelerationX = accelerations.getColumn(0)[i + 1];
//            double nextAccelerationY = accelerations.getColumn(1)[i + 1];
//            double nextNextAccelerationX = accelerations.getColumn(0)[i + 2];
//            double nextNextAccelerationY = accelerations.getColumn(1)[i + 2];

//            RealMatrix newAcc = getR().multiply(new Array2DRowRealMatrix (new double [][] {ax.getColumn(0), ay.getColumn(0), az.getColumn(0)}));
            double currentAccelerationX = newAcc.getRow(i)[0];
            double currentAccelerationY = newAcc.getRow(i)[1];
            double nextAccelerationX = newAcc.getRow(i + 1)[0];
            double nextAccelerationY = newAcc.getRow(i + 1)[1];
            double nextNextAccelerationX = newAcc.getRow(i + 2)[0];
            double nextNextAccelerationY = newAcc.getRow(i + 2)[1];

            double velocityX = trapezoidalRuleForVelocity(currentAccelerationX, nextAccelerationX);
            double velocityY = trapezoidalRuleForVelocity(currentAccelerationY, nextAccelerationY);
            double positionX = trapezoidalRuleForPosition(velocityX, trapezoidalRuleForVelocity(nextAccelerationX, nextNextAccelerationX));
            double positionY = trapezoidalRuleForPosition(velocityY, trapezoidalRuleForVelocity(nextAccelerationY, nextNextAccelerationY));


            this.measurements[i][0] = positionX;
            this.measurements[i][1] = positionY;
            this.measurements[i][2] = velocityX;
            this.measurements[i][3] = velocityY;
        }
        this.Q = new Array2DRowRealMatrix(new double[][]{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}); // Process noise covariance matrix (set to zero)
//        this.R = new Array2DRowRealMatrix(new double[][]{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}});
        this.R = new Array2DRowRealMatrix(new double[][]{{delta_x * delta_x, 0, 0, 0}, {0, delta_y * delta_y, 0, 0}, {0, 0, delta_xv * delta_xv, 0}, {0, 0, 0, delta_yv * delta_yv}}); // Measurement noise covariance matrix
        this.P = new Array2DRowRealMatrix(new double[][]{{deltaPx * deltaPx, 0, 0, 0}, {0, deltaPy * deltaPy, 0, 0}, {0, 0, deltaPxv * deltaPxv, 0}, {0, 0, 0, deltaPyv * deltaPyv}}); // Initial process covariance matrix
        this.X = new Array2DRowRealMatrix(new double[][]{{this.measurements[0][0]}, {this.measurements[0][1]}, {this.measurements[0][2]}, {this.measurements[0][3]}}); // Initial state: [positionX, positionY, velocityX, velocityY]
//        this.X = new Array2DRowRealMatrix(new double[][]{{0}, {0}, {0}, {0}});
        this.A = new Array2DRowRealMatrix(new double [][] {{1, 0, delta_t, 0}, {0, 1, 0, delta_t}, {0, 0, 1, 0}, {0, 0, 0, 1}});  // State transition matrix
        this.B = new Array2DRowRealMatrix(new double [][] {{0.5 * delta_t * delta_t, 0}, {0, 0.5 * delta_t * delta_t}, {delta_t, 0}, {0, delta_t}}); // Control input matrix
        this.H = new Array2DRowRealMatrix(H); // Observation matrix
        this.C = new Array2DRowRealMatrix(C); // Observation matrix for the output equation
//        this.Z = new Array2DRowRealMatrix(new double[][]{{this.measurements[currentIndex][0]}, {this.measurements[currentIndex][1]}, {this.measurements[currentIndex][2]},
//                {this.measurements[currentIndex][3]}});
//        this.Z = new Array2DRowRealMatrix(new double[][]{{0}, {0}, {0}, {0}});
        this.currentIndex = 0; // Start with the first acceleration value


        positionSeries = new XYSeries("Position");
        velocitySeries = new XYSeries("Velocity");
//        positionSeries.add(0, 0);
    }


    public void update() {

        // Step 1: Calculate the predicted state
        RealMatrix newAccWithoutZ = new Array2DRowRealMatrix(new double [][] {newAcc.getColumn(0), newAcc.getColumn(1)}).transpose();
        X_hat = A.multiply(X).add(B.multiply((newAccWithoutZ.getRowMatrix(currentIndex)).transpose()));


        // Step 2: Calculate the predicted process covariance matrix
        P = A.multiply(P).multiply(A.transpose()).add(Q);


        // Step 3: Calculate the Kalman gain
        RealMatrix H_transpose = H.transpose();
        RealMatrix S = H.multiply(P).multiply(H_transpose).add(R);
        LUDecomposition lu = new LUDecomposition(S);
        K = P.multiply(H_transpose).multiply(lu.getSolver().getInverse());

        // Step 4: Calculate the new observation
        // Move to the next acceleration value
        this.currentIndex++;
        if(this.currentIndex == (newAcc.getColumn(0).length - 2))
        {
            return;
        }
        RealMatrix Y = C.multiply(new Array2DRowRealMatrix(new double[][]{{this.measurements[currentIndex][0]},
                                         {this.measurements[currentIndex][1]}, {this.measurements[currentIndex][2]},
                                         {this.measurements[currentIndex][3]}}));


//        RealMatrix Y = C.multiply(new Array2DRowRealMatrix(new double[][]{{this.measurements[currentIndex][0]},
//                                 {this.measurements[currentIndex][1]}, {this.measurements[currentIndex][2]},
//                                 {this.measurements[currentIndex][3]}})).add(Z);


        // Step 5: Calculate the current state
        X = X_hat.add(K.multiply(Y.subtract(H.multiply(X_hat))));


        // Step 6: Update the process covariance matrix
        RealMatrix I = MatrixUtils.createRealIdentityMatrix(P.getRowDimension());
        P = I.subtract(K.multiply(H)).multiply(P);


        System.out.println(currentIndex * delta_t);
        positionSeries.add(getState()[0], getState()[1]);
        velocitySeries.add(getState()[2], getState()[3]);

    }


    private double trapezoidalRuleForVelocity(double acceleration, double nextAcceleration) {
        return ((acceleration + nextAcceleration) / 2.0) * delta_t;
    }

    private double trapezoidalRuleForPosition(double currentVelocity, double nextVelocity) {
        return ((currentVelocity + nextVelocity) / 2.0) * delta_t;
    }



    public double[] getState() {
        return X.getColumn(0);
    }


    public void printMeasurements(double [] accelerations)
    {
        double [][] temp = this.measurements;
        for(int i = 0; i < temp.length; ++i)
        {
            for(int j = 0; j < temp[i].length; ++j)
            {
                System.out.print(temp[i][j] + " ");
            }
            System.out.println();
        }
    }


    public RealMatrix getR() {

        RealMatrix R = MatrixUtils.createRealIdentityMatrix(3);
        for(int i = 0; i < eulerX.getColumn(0).length; ++i) {
            RealMatrix Rx = new Array2DRowRealMatrix(new double [][] { {1, 0, 0 }, { 0, Math.cos(eulerX.getRow(i)[0]), -Math.sin(eulerX.getRow(i)[0]) },
                    { 0, Math.sin(eulerX.getRow(i)[0]), Math.cos(eulerX.getRow(i)[0]) } });

            RealMatrix Ry = new Array2DRowRealMatrix(new double [][] { { Math.cos(eulerY.getRow(i)[0]), 0, Math.sin(eulerY.getRow(i)[0]) }, { 0, 1, 0 },
                { -Math.sin(eulerY.getRow(i)[0]), 0, Math.cos(eulerY.getRow(i)[0]) } });

            RealMatrix Rz = new Array2DRowRealMatrix(new double [][] { { Math.cos(eulerZ.getRow(i)[0]), -Math.sin(eulerZ.getRow(i)[0]), 0 }, { Math.sin(eulerZ.getRow(i)[0]), Math.cos(eulerZ.getRow(i)[0]), 0 },
                    { 0, 0, 1 } });

           R  = Rz.multiply(Ry).multiply(Rx);


        }
        return R;
    }

    public void plotResults() {
////        // Create a dataset for position and velocity series
//        XYSeriesCollection dataset = new XYSeriesCollection();
//        dataset.addSeries(positionSeries);
//        //dataset.addSeries(velocitySeries);
//
//        // Create the chart
//        JFreeChart chart = ChartFactory.createXYLineChart(
//                "Kalman Filter Results",
//                "Px",
//                "Py",
//                dataset
//        );
//
////         Invert Y-axis
////        chart.getXYPlot().getRangeAxis().setInverted(true);
////        chart.getXYPlot().getDomainAxis().setInverted(true);
//        // Create and set up the frame
//        JFrame frame = new JFrame("Kalman Filter Results");
//        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
//        frame.setLayout(new BorderLayout());
//
//        // Add the chart to a panel
//        ChartPanel chartPanel = new ChartPanel(chart);
//        frame.add(chartPanel, BorderLayout.CENTER);
//
//        // Display the frame
//        frame.pack();
//        frame.setVisible(true);


//         Create a dataset for position and velocity series
        XYSeriesCollection dataset = new XYSeriesCollection();
        dataset.addSeries(positionSeries);
        //dataset.addSeries(velocitySeries);

        // Create the chart
        JFreeChart chart = ChartFactory.createXYLineChart(
                "Kalman Filter Results",
                "Px",
                "Py",
                dataset
        );

        // Invert Y-axis
//        chart.getXYPlot().getRangeAxis().setInverted(true);

        chart.getXYPlot().getDomainAxis().setInverted(true);

        // Create and set up the frame
        JFrame frame = new JFrame("Kalman Filter Results");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new BorderLayout());

        // Add the chart to a panel
        ChartPanel chartPanel = new ChartPanel(chart);
        frame.add(chartPanel, BorderLayout.CENTER);

        // Display the frame
        frame.pack();
        frame.setVisible(true);

    }

    public static void main(String[] args) {
        // Initial values
        //double[] initialState = {4000, 280}; // Initial state: [position, velocity]
        double deltaPx = 20;
        double deltaPy = 20;
        double deltaPxv = 5;
        double deltaPyv = 5;

        double delta_x = 25;
        double delta_y = 25;
        double delta_xv = 6;
        double delta_yv = 6;
        double delta_t = 0.01;
        //double[][] A = {{1, delta_t}, {0, 1}}; // State transition matrix
        //double[][] B = {{0.5 * delta_t * delta_t}, {delta_t}};
        double[][] H = {{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}; // Observation matrix
        double[][] C = {{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}; // Observation matrix for the output equation


//        String filePathAcc = "C:\\Users\\User\\IdeaProjects\\KalmanFilter\\src\\main\\java\\org\\example\\dataAcceleration.txt";
//
//        RealMatrix accelerations1 = loadDataFromFile(filePathAcc);
//
//
//        String filePathEulerX = "C:\\Users\\User\\IdeaProjects\\KalmanFilter\\src\\main\\java\\org\\example\\eulerXData.txt";
//        RealMatrix eulerX1 = loadDataFromFile(filePathEulerX);
//
//
//        String filePathEulerY = "C:\\Users\\User\\IdeaProjects\\KalmanFilter\\src\\main\\java\\org\\example\\eulerYData.txt";
//
//        RealMatrix eulerY1 = loadDataFromFile(filePathEulerY);
//
//
//        String filePathEulerZ = "C:\\Users\\User\\IdeaProjects\\KalmanFilter\\src\\main\\java\\org\\example\\eulerZData.txt";
//
//        RealMatrix eulerZ1 = loadDataFromFile(filePathEulerZ);


        // Example accelerations
        RealMatrix accelerations = new Array2DRowRealMatrix(new double[][]{  {0.000210158,0.001336694,-0.010737477},
                {0.002036421,-0.001830513,-0.012324274},
                {0.002149662,-0.000476537,-0.012568355},
                {0.000312362,0.001600924,-0.013300717},
                {-0.00042058,0.001352887,-0.013911067},
                {0.000312192,0.002567959,-0.013300894},
                {0.001773171,-0.000242778,-0.011347771},
                {0.000181439,-0.003040986,-0.012202203},
                {5.95E-05,-0.000102199,-0.010859309},
                {-0.002622006,0.000626158,-0.014155209},
                {-0.000905205,-0.000597155,-0.011591673},
                {0.001049784,0.000138294,-0.011347532},
                {0.004580246,-0.000955658,-0.012079952},
                {0.00273542,-0.001436798,-0.015742004},
                {-0.001048718,-0.000941652,-0.011713564},
                {-0.001893298,0.001379885,-0.009027896},
                {6.72E-05,-0.000938152,-0.010981023},
                {0.001404673,-0.003123334,-0.014276743},
                {-0.000429991,-0.001891128,-0.013422072},
                {-0.000671544,0.001647281,-0.009882091},
                {-0.001521006,0.002121617,-0.011957524},
                {0.000433711,0.000768279,-0.013178287},
                {0.000796994,-0.001796608,-0.012201786},
                {0.000185325,-0.00154787,-0.011103034},
                {0.00055239,0.001499576,-0.011957703},
                {6.34E-05,0.003681153,-0.014887571},
//                {0.000672263,0.000738988,-0.011591909},//
//                {0.000426559,0.000370411,-0.011836052},
//                {0.003594405,0.000248312,-0.011469841},
//                {-0.000564661,-0.000240711,-0.016474839},
//                {-0.000681653,0.001951653,-0.010493455},
//                {-0.001406572,0.004134459,-0.010249434},
//                {0.003110372,-0.000878325,-0.010737834},
//                {0.00151352,-0.001966531,-0.015132306},
//                {0.002118541,0.001576822,-0.012690842},
//                {-0.001300755,0.002300978,-0.012813091},//
//                {4.66E-05,0.002413251,-0.012080729},
//                {-0.001415209,0.0024042,-0.012935398},
//                {0.000174403,-0.002961077,-0.009517252},
//                {-7.17E-05,-0.001113656,-0.011103928},
//                {0.000657344,0.002913584,-0.013545452},
//                {-0.003127785,-0.001364697,-0.015864909},
//                {0.001022996,-0.001600225,-0.008662581},
//                {0.001016257,0.000604936,-0.010127366},
//                {0.003935128,-0.0017106,-0.011470139},
//                {-0.000225661,-0.001091411,-0.014521776},
//                {-0.000831308,0.002202087,-0.008906541},
//                {-0.003261909,-0.001950235,-0.012324452},
//                {0.001626019,-0.002301301,-0.011347709},
//                {0.000888765,0.00027294,-0.015131712},
//                {0.001130332,-0.001553068,-0.011469603},
//                {3.06E-05,0.000770303,-0.011957765},
//                {0.000885876,0.00271548,-0.012324033},
//                {0.001980353,-0.002780426,-0.011713743},
//                {0.001484127,-0.003619702,-0.012079835},
//                {0.001235822,0.001022964,-0.012812255},
//                {-0.000108098,0.001988386,-0.014643431},
//                {-0.000836545,-9.42E-05,-0.012080014},
//                {0.000631611,0.001123487,-0.012202144},
//                {0.003433429,-0.001561294,-0.011958003},
//                {0.001835539,0.000153476,-0.01610833},
//                {-0.001459299,0.001006778,-0.012812495},
//                {-0.001570839,0.00270508,-0.008173943},
//                {0.000633065,0.000252929,-0.010249315},
//                {0.001847013,-0.00144979,-0.014521657},
//                {0.000985792,-0.001320007,-0.014155388},
//                {0.000493774,0.002949327,-0.011836052},
//                {-0.00036091,0.002934253,-0.012690783},
//                {-0.000358711,0.001337031,-0.012446819},
//                {0.001349158,-0.001104029,-0.010371683},
//                {-0.000362346,-0.001219403,-0.012446702},
//                {0.001103714,0.000610936,-0.01232475},
//                {-0.001214971,0.002798376,-0.015986856},
//                {-0.000355786,-0.000260753,-0.011592507},
//                {0.000744638,-0.000501904,-0.011958659},
//                {0.004154689,0.000356611,-0.011714518},
//                {0.00109035,0.002064832,-0.016109046},
//                {-0.001105092,0.000598599,-0.011104284},
//                {-0.00304784,0.002671291,-0.010982154},
//                {0.000378901,-0.001599284,-0.011226177},
//                {0.000863825,-0.001829318,-0.014155746},
//                {0.000737353,-0.000233078,-0.012568712},
//                {1.33E-06,0.002449892,-0.01134795},
//                {0.000851795,0.000123094,-0.012080608},
//                {-0.000495335,-0.001827564,-0.013911605},
//                {0.000601538,-0.003646133,-0.010859609},
//                {-1.12E-05,-0.001801174,-0.01098156},
//                {0.000597068,0.000639734,-0.012446461},
//                {-0.000869344,0.001242607,-0.013911424},
//                {-1.36E-05,-0.000468681,-0.010981679},
//                {-0.000986212,-0.00216996,-0.012080193},
//                {0.002188975,-0.000208514,-0.011225522},
//                {0.000109795,0.00052321,-0.01464355},
//                {0.000964745,-0.000575903,-0.010004878},
//                {-0.000133983,0.00028155,-0.009882808},
//                {0.003158718,-0.001421257,-0.011591733},
//                {0.000952408,-0.002386222,-0.015131591},
//                {0.00119266,0.001279897,-0.011591494},
//                {0.000455766,0.003587346,-0.011591733},
//                {0.000696784,0.000157512,-0.012446404},
//                {-0.000159497,-0.000573412,-0.011347711},
//                {-0.001254297,-0.001299463,-0.010981441},
//                {-0.00185667,0.000168656,-0.011957884},
//                {-2.13E-05,0.002356816,-0.013056694},
//                {-0.00172838,0.001366654,-0.013911366},
//                {0.000470053,-0.001562799,-0.009272754},
//                {0.002659689,0.001494833,-0.010981619},
//                {0.003744298,0.000881164,-0.013789354},
//                {-0.000413821,-0.002411151,-0.01537621},
//                {-0.001870615,0.00295672,-0.008662401},
//                {-0.003438927,0.002329223,-0.010127425},
//                {0.000478892,-0.001819438,-0.010493577},
//                {-0.000495896,0.002095567,-0.013911307},
//                {0.000362975,0.002093269,-0.012812672},
//                {0.001097338,0.000628106,-0.013178945},
//                {0.003047195,0.001972994,-0.012324391},
//                {0.002674272,-0.001805614,-0.012324393},
//                {0.001693614,-0.004229902,-0.011225462},
//                {-0.00013595,0.00127468,-0.011347413},
//                {-0.001594424,0.001393328,-0.013300478},
//                {-0.001464535,-0.001289148,-0.012568055},
//                {-0.000967947,0.000183254,-0.011713443},
//                {0.001723853,0.00055125,-0.012201665},
//                {0.001967098,-0.001277628,-0.014154673},
//                {-0.001447093,0.000312802,-0.012567699},
//                {-0.001922944,0.002991424,-0.008173166},
//                {0.0001617,0.000784153,-0.010370553},
//                {0.000647672,5.57E-05,-0.015009284},
//                {-0.002527755,0.001403777,-0.016229805},
//                {-0.001792592,0.003599788,-0.011591196},
//                {-0.001911903,0.005423705,-0.015009284},
//                {0.001017111,0.001761803,-0.016107857},
//                {0.002354523,-0.00054654,-0.01366639},
//                {0.004419351,-0.00223902,-0.009393631},
//                {0.00343408,0.00033438,-0.013666034},
//                {0.002954167,0.00386536,-0.016473711},
//                {0.001871641,0.003483168,-0.015741523},
//                {0.001888217,0.00188557,-0.015375376},
//                {0.005437064,0.00078558,-0.015131176},
//                {0.00592242,0.001035845,-0.016473889},
//                {0.006887057,-0.002001834,-0.011835037},
//                {0.006126688,-0.003195547,-0.005365014},
//                {0.00755137,-0.009369292,-0.00255692},
//                {0.008976573,-0.012591042,-0.002555847},
//                {0.005045792,-0.012031076,-0.003165245},
//                {0.001148792,-0.007482651,-0.007071018},
//                {0.001781793,-0.008578204,-0.006948709},
//                {-0.00600355,-0.016745673,-0.009023665},
//                {-0.002311626,-0.014649667,-0.005361139},
//                {-0.004853593,-0.012086587,-0.009145081},
//                {-0.005198766,-0.013450368,-0.009145377},
//                {-0.009939278,-0.008237953,-0.012319684},
//                {-0.010038804,-0.008779733,-0.008658288},
//                {-0.009043252,-0.012253096,-0.007926583},
//                {-0.009151772,-0.007924428,-0.011711717},
//                {-0.013414936,-0.003131016,-0.016595896},
//                {-0.012552649,-0.003111004,-0.011226295},
//                {-0.013523661,-0.000654427,-0.011838198},
//                {-0.010346512,0.001307835,-0.01391506},
//                {-0.007177569,0.003632669,-0.015259622},
//                {-0.005724578,0.007299087,-0.017336544},
//                {-0.0079361,0.016822262,-0.02075636},
//                {-0.003804364,0.012679148,-0.017950535},
//                {-0.004073448,0.013802877,-0.01978308},
//                {-7.35E-05,0.016647078,-0.018685699},
//                {0.003551741,0.017549399,-0.018564936},
//                {0.003754621,0.023468381,-0.022594333},
//                {0.004201543,0.02110197,-0.022106886},
//                {0.006475161,0.020953752,-0.018201288},
//                {0.008991368,0.02021661,-0.022351921},
//                {0.013091934,0.019260619,-0.020032525},
//                {0.009992532,0.02174074,-0.020154297},
//                {0.011171808,0.021062214,-0.013195751},
//                {0.009668795,0.017473564,-0.015270112},
//                {0.012078058,0.013786196,-0.016123295},
//                {0.010584908,0.013288314,-0.014290748},
//                {0.01019684,0.01145786,-0.009528397},
//                {0.00749662,0.011467568,-0.011235535},
//                {0.006392276,0.006971637,-0.009036122},
//                {0.007490979,0.000171276,-0.004761398},
//                {0.004323478,-0.00100596,-0.007932721},
//                {0.002508582,-0.002917147,-0.00793004},
//                {-0.000521558,-0.003854265,-0.005730271},
//                {-0.003787873,-0.007722671,-0.0060938},
//                {-0.003142931,-0.010980453,-0.00340563},
//                {-0.003715572,-0.012656076,-0.007919608},
//                {-0.004162687,-0.01507378,-0.010602711},
//                {-0.008268561,-0.017746443,-0.007670522},
//                {-0.009196059,-0.015793737,-0.006936014},
//                {-0.006338686,-0.020323688,-0.009253204},
//                {-0.005803096,-0.021809768,-0.009983778},
//                {-0.005998814,-0.018551411,-0.011202812},
//                {-0.007657201,-0.017877953,-0.013032556},
//                {-0.006750591,-0.01466001,-0.013031602},
//                {-0.007311333,-0.013536796,-0.014251649},
//                {-0.003974156,-0.01597335,-0.010955453},
//                {-0.0018705,-0.012570484,-0.012054265},
//                {-0.00026591,-0.007979834,-0.01571703},
//                {0.000107792,-0.008050237,-0.015718162},
//                {0.000839369,-0.007032224,-0.011447011},
//                {-2.23E-05,-0.004439006,-0.012913406},
//                {0.001672956,-0.003076665,-0.01132822},
//                {-0.001155729,0.00279331,-0.013039229},
//                {-0.000814027,0.004018502,-0.009745359},
//                {-0.000355151,0.004027893,-0.01170045},
//                {0.002540478,0.004777328,-0.012312589},
//                {0.001647973,0.006874036,-0.013168871},
//                {0.000756038,0.008851402,-0.010362983},
//                {-0.001354693,0.015223956,-0.011707425},
//                {-0.001020896,0.015618905,-0.012685655},
//                {-0.001050906,0.012244333,-0.011710405},
//                {-0.000346569,0.012179852,-0.014519094},
//                {-0.001468342,0.013831149,-0.016229089},
//                {-0.000754522,0.015241906,-0.014154851},
//                {-0.001500558,0.014703364,-0.013545275},
//                {0.002149236,0.01185009,-0.01037222},
//                {0.004694596,0.011325655,-0.012936292},
//                {0.00577779,0.01192312,-0.015744209},
//                {0.004915371,0.00838756,-0.014645636},
//                {0.005037523,0.006822284,-0.010861099},
//                {0.005654269,0.005024635,-0.010982573},
//                {0.009324236,0.002872658,-0.010005353},
//                {0.010185245,0.002191766,-0.008661747},
//                {0.007633497,0.000779238,-0.011956811},
//                {0.010214552,0.001318692,-0.009758651},
//                {0.006448721,-0.002535744,-0.009513674},
//                {0.000986921,-0.007848404,-0.010611234},
//                {0.003583779,-0.007058079,-0.003774226},
//                {0.001782325,-0.009081466,-0.007679521},
//                {-0.003307728,-0.00732787,-0.016223606},
//                {-0.00180288,-0.011678379,-0.007311523},
//                {-0.006277058,-0.008943142,-0.009507835},
//                {-0.008545821,-0.005366175,-0.015488444},
//                {-0.008254129,-0.009971289,-0.011825502},
//                {-0.013817918,-0.004322745,-0.013533711},
//                {-0.015587166,-0.000888722,-0.01170212},
//                {-0.015160136,-0.00185545,-0.01487541},
//                {-0.015232662,-0.000138255,-0.018781304},
//                {-0.010922376,-0.000623578,-0.017072082},
//                {-0.014799502,0.006448786,-0.021344598},
//                {-0.010014503,0.006670563,-0.016217764},
//                {-0.00987941,0.005427171,-0.017316759},
//                {-0.004995471,0.007236681,-0.016828831},
//                {-0.003422168,0.002211772,-0.01939261},
//                {-0.000273304,0.004273021,-0.017073687},
//                {-0.000184833,0.007428025,-0.016219672},
//                {0.004410284,0.000334846,-0.011581421},
//                {0.00813687,0.000824645,-0.011215506},
//                {0.014658879,0.002413759,-0.010971665},
//                {0.011653881,-0.003925058,-0.012680946},
//                {0.011949126,-0.001219731,-0.007187724},
//                {0.013338022,-0.00010499,-0.004746555},
//                {0.012409553,-0.00862488,-0.006821692},
//                {0.00953644,-0.006268414,-0.006088972},
//                {0.009597508,-0.003188071,-0.002914905},
//                {0.004661896,-0.003655973,-0.00926262},
//                {0.004867854,-0.004125671,-0.00791961},
//                {0.001175536,-0.003985478,-0.007064998},
//                {-0.000422783,-0.007500855,-0.0068205},
//                {-0.002617524,-0.00516322,-0.011825202},
//                {-0.002728408,7.15E-05,-0.014022589},
//                {-0.005761356,-0.003374038,-0.014877379},
//                {-0.006466065,-0.004619068,-0.014755547},
//                {-0.007042459,-0.004402753,-0.018173814},
//                {-0.006517566,-0.002120489,-0.018052161},
//                {-0.007822633,-0.002164606,-0.01902926},
//                {-0.007783309,-0.000501996,-0.017198797},
//                {-0.0043275,-0.000427898,-0.016222715},
//                {-0.002464157,-0.00388978,-0.018786784},
//                {-0.002801512,-0.002221973,-0.018665195},
//                {0.000637888,0.000660907,-0.01463747},
//                {-0.000814608,0.004512692,-0.01671344},
//                {0.00065691,0.001649718,-0.013906656},
//                {0.000168265,0.000503515,-0.012198448},
//                {-0.000322801,0.001313711,-0.014274359},
//                {0.000647412,0.000171502,-0.014030933},
//                {0.001121626,0.004765471,-0.011834441},
//                {0.000248629,0.004229793,-0.010248303},
//                {0.001204051,0.002237153,-0.005488276},
//                {0.002400121,0.004277512,-0.006831705},
//                {-0.000552206,0.006924009,-0.010372458},
//                {-0.001300815,0.005174795,-0.007321417},
//                {-0.002656317,0.006600453,-0.005613028},
//                {-0.002784995,0.00302486,-0.007566749},
//                {-0.000962283,0.0023929,-0.006712556},
//                {-0.002433977,0.00554214,-0.006835102},
//                {-0.00121492,0.006850258,-0.007445871},
//                {0.000854469,0.004621402,-0.009521604},
//                {0.000113994,0.003871544,-0.012329519},
//                {-0.000984885,0.002402209,-0.007568836},
//                {-0.000736744,0.003376578,-0.00988823},
//                {0.000364135,0.006178259,-0.014648972},
//                {-3.30E-06,0.006295268,-0.016724229},
//                {0.0017058,7.94E-05,-0.013794482},
//                {0.000605195,0.000474219,-0.015502989},
//                {0.003046503,0.005138838,-0.017333742},
//                {0.001210103,0.003325722,-0.019042492},
//                {-0.000381079,-0.001286398,-0.016356524},
//                {-0.00196909,0.002529105,-0.017210599},
//                {0.001449013,-0.002327104,-0.017088115},
//                {0.0008322,-0.005220544,-0.019650996},
//                {0.002655593,0.000184832,-0.016598757},
//                {0.001423608,0.001427407,-0.0170868},
//                {0.000683191,-0.001847191,-0.015255451},
//                {-0.000664736,-0.005966149,-0.011226773},
//                {-0.002007203,-0.005924193,-0.010127483},
//                {-0.002367448,-0.003932158,-0.012079954},
//                {-0.001264019,-0.00329529,-0.009271918},
//                {-0.002112239,-0.003146316,-0.008538961},
//                {0.000340145,-0.00518243,-0.003289342},
//                {0.001433804,-0.006822702,-0.006218016},
//                {0.002156227,-0.002743861,-0.009024916},
//                {-0.000655965,-0.002372167,-0.009146867},
//                {-0.001137641,-0.002490303,-0.00572884},
//                {-0.001372491,-0.002603506,-0.007437587},
//                {-0.000876791,-0.001500278,-0.009268641},
//                {-0.000506821,-0.001504151,-0.010245202},
//                {0.000104082,0.001295281,-0.011588095},
//                {0.000469278,0.004083868,-0.015006304},
//                {0.000955234,0.00345064,-0.014152169},
//                {9.68E-05,0.00111372,-0.012199342},
//                {-2.84E-05,0.00342044,-0.013054131},
//                {0.001065985,0.007058539,-0.014275132},
//                {-0.001625838,0.005807824,-0.016839147},
//                {-0.000648755,0.006151203,-0.012933193},
//                {-0.000525987,0.006612991,-0.012445331},
//                {0.001184274,0.00329222,-0.014520943},
//                {-0.000649334,0.007306451,-0.014399109},
//                {-0.001011502,0.006913722,-0.010249076},
//                {-0.003077187,0.002005764,-0.010493636},
//                {0.000842078,0.002009643,-0.009883046},
//                {0.00072212,0.00274925,-0.012568472},
//                {0.001335668,7.42E-05,-0.012568353},
//                {0.000483445,0.003142942,-0.013300477},
//                {0.000123267,0.003398664,-0.011957526},
//                {-0.000967293,-0.001465375,-0.011590956},
//                {0.000751086,-0.002895231,-0.011834502},
//                {-0.001683945,6.97E-05,-0.016960919},
//                {-0.000209804,9.57E-05,-0.016350087},
//                {-0.002522292,-0.000855298,-0.016837955},
//                {0.000293048,-0.001680505,-0.014274061},
//                {0.000782069,-0.004942187,-0.015738364},
//                {0.001878393,-0.001853633,-0.016104039},
//                {-0.001054237,-0.000120688,-0.016714033},
//                {-0.002637946,-0.002665688,-0.011220515},
//                {-0.002994084,-0.002762157,-0.010609686},
//                {-0.003468896,-0.002982253,-0.01097548},
//                {-0.003450025,-0.003204498,-0.009388089},
//                {-0.002572594,-1.40E-05,-0.008044958},
//                {-0.002801114,0.000220801,-0.010242283},
//                {-0.001567506,-0.00259607,-0.006824493},
//                {-0.003872807,-0.001496114,-0.008655429},
//                {-0.001536563,-0.000650767,-0.009509921},
//                {0.001027152,-0.000908412,-0.008167444},
//                {-0.003618708,0.001153968,-0.018421587},
//                {4.62E-05,0.001869795,-0.011952043},
//                {0.001504282,-0.003753708,-0.012196301},
//                {0.002957932,-0.002883973,-0.017689347},
//                {0.005140416,0.002734832,-0.016468644},
//                {0.003533017,-0.00410318,-0.014393626},
//                {0.005586338,-0.003108983,-0.01060921},
//                {0.006163672,-0.003946842,-0.012562273},
//                {0.006377811,-0.004910031,-0.01524776},
//                {0.006720132,-0.004781741,-0.013782859},
//                {0.002916048,-0.000148598,-0.015492082},
//                {0.002666144,-0.000416458,-0.011586249},
//                {-0.002340734,-0.005078123,-0.013173519},
//                {-0.001597448,-0.002898511,-0.009145439},
//                {-0.005245533,-0.000120078,-0.013662398},
//                {-0.004980067,0.003865282,-0.014151273},
//                {-0.008740259,0.003084102,-0.015494645},
//                {-0.006633862,0.00279772,-0.009880004},
//                {-0.007821875,0.005322696,-0.015129328},
//                {-0.005471062,0.007115958,-0.015129805},
//                {-0.007274949,0.008422233,-0.016473051},
//                {-0.008098737,0.00973229,-0.013665734},
//                {-0.006721374,0.010921423,-0.013910232},
//                {-0.003518139,0.008697797,-0.014032483},
//                {-0.002280949,0.010757194,-0.014398873},
//                {0.001142531,0.010862077,-0.012323914},
//                {0.001989962,0.012433955,-0.012324214},
//                {0.003075982,0.010472903,-0.010615407},
//                {0.00293553,0.00693942,-0.008051872},
//                {0.004987143,0.004274853,-0.007563412},
//                {0.004223758,0.005035015,-0.010248719},
//                {0.004678943,0.005794784,-0.008661509},
//                {0.003666933,0.000333131,-0.006586075},
//                {0.004854173,-0.001449859,-0.006097137},
//                {0.007018295,-0.003469255,-0.007439255},
//                {0.006007551,-0.004752974,-0.010368228},
//                {0.004514047,-0.007010915,-0.010245323},
//                {0.002537913,-0.007432938,-0.008901715},
//                {0.001423437,-0.011269006,-0.009510994},
//                {0.000314832,-0.011071976,-0.013538122},
//                {0.001286127,-0.009540051,-0.014269531},
//                {6.23E-05,-0.007651729,-0.016832169},
//                {-0.00066583,-0.008947859,-0.016221046},
//                {-0.00346212,-0.011589566,-0.015976187},
//                {-0.004540769,-0.010572856,-0.014876723},
//                {-0.004882748,-0.008714093,-0.017927945},
//                {-0.00351727,-0.005293158,-0.018049952},
//                {-0.006182147,-0.005554221,-0.020247336},
//                {-0.004816763,-0.007288433,-0.015975233},
//                {-0.004063339,-0.006585056,-0.016463757},
//                {-0.000872425,-0.003207216,-0.017074704},
//                {-0.00293646,-0.000942241,-0.01731962},
//                {-0.001338024,-0.002099853,-0.011339009},
//                {-0.003647042,-0.000811929,-0.012194335},
//                {-0.000217419,0.000963279,-0.010730386},
//                {0.000883753,0.001882754,-0.012684403},
//                {0.002833394,0.004877826,-0.011830747},
//                {0.00270256,0.007868952,-0.010733128},
//                {0.00415638,0.006465559,-0.009269238},
//                {0.004873671,0.006411834,-0.007194936},
//                {0.005342659,0.008189862,-0.0070737},
//                {0.00532095,0.010452496,-0.009760259},
//                {0.0028591,0.011982106,-0.010859905},
//                {-8.33E-05,0.010336705,-0.008297322},
//                {-0.00033073,0.008687463,-0.006345271},
//                {-0.000208271,0.008498086,-0.009397922},
//                {-0.000452069,0.009666211,-0.011107741},
//                {-0.000326836,0.006332896,-0.009643493},
//                {-0.000444294,0.005226696,-0.009033142},
//                {5.06E-05,0.003771552,-0.010864079},
//                {-0.000431201,0.001721927,-0.013427077},
//                {-0.000911202,0.002002975,-0.012327967},
//                {-0.003830451,0.003384566,-0.015256939},
//                {-0.002228056,0.001105494,-0.013791382},
//                {-0.004288373,-0.000678677,-0.01501137},
//                {-0.001830024,-0.003313828,-0.011958778},
//                {-0.001451193,-0.004726707,-0.015131712},
//                {0.000269284,-0.001995436,-0.014642715},
//                {-0.000822075,-0.003913383,-0.015984833},
//                {0.00113728,-0.008514091,-0.010735273},
//                {0.00101547,-0.006635331,-0.012931762},
//                {0.002600126,-0.005622976,-0.01415199},
//                {-0.000579937,-0.006449957,-0.014517784},
//                {-0.002775055,-0.005569567,-0.010977386},
//                {-0.002156355,-0.006762565,-0.011220992},
//                {0.000651985,-0.009660445,-0.011220455},
//                {3.15E-05,-0.005478714,-0.01317328},
//                {0.002585292,-0.005228656,-0.011342049},
//                {0.001959003,-0.004492896,-0.01280701},
//                {0.001458989,-0.002785941,-0.012074649},
//                {-0.000502298,-0.005109745,-0.010732055},
//                {-0.000627709,-0.004739907,-0.009267032},
//                {-0.001241308,0.000747772,-0.01268518},
//                {-0.000877392,0.002428281,-0.012685597},
//                {-0.001122545,0.000564979,-0.010733008},
//                {-0.000753572,0.00248981,-0.010123014},
//                {0.001448353,0.001968397,-0.011710405},
//                {0.00132772,0.004131746,-0.013419984},
//                {-0.001354086,0.006167375,-0.013054429},
//                {-0.001589301,0.005149196,-0.010003207},
//                {-0.001213202,0.003282837,-0.012689171},
//                {-0.00144961,0.005333117,-0.014398575},
//                {-0.00034453,0.006892704,-0.013788581},
//                {-0.001316841,0.007350178,-0.015009701},
//                {0.000276125,0.007688516,-0.014277754},
//                {-0.000454446,0.005711429,-0.014033971},
//                {0.00064657,0.003749948,-0.011470556},
//                {0.000155806,0.00423739,-0.013301669},
//                {0.001496174,0.006312247,-0.013301671},
//                {-0.001439116,0.003991376,-0.016475558},
//                {-0.001072732,0.001560918,-0.012080908},
//                {-0.000950805,0.001456722,-0.011714339},
//                {0.002098366,0.00208533,-0.012690604},
//                {0.000868741,0.000515825,-0.014887748},
//                {0.000741296,-0.002024455,-0.010981083},
//                {-0.001092798,-0.002481822,-0.010370314},
//                {0.001105335,-0.004400359,-0.009881496},
//                {0.001343314,-0.003751409,-0.011712013},
//                {0.001581067,-0.00347514,-0.011589468},
//                {0.000477297,-0.00369053,-0.011222839},
//                {0.000965413,-0.004393704,-0.009757519},
//                {-0.000498272,-0.003630945,-0.009757161},
//                {0.001703973,-0.006898309,-0.008657932},
//                {0.001333428,-0.006369185,-0.010976672},
//                {0.00072328,-0.002929195,-0.010854244},
//                {-0.002687525,-0.004879354,-0.011464477},
//                {-0.001206019,-0.005847516,-0.009267149},
//                {-0.000461763,-0.003640996,-0.012196541},
//                {0.000643775,-0.001330066,-0.013417304},
//                {-0.001427391,-0.002446544,-0.015736997},
//                {-0.001418244,-0.000266647,-0.010854421},
//                {-0.001651195,0.002029826,-0.012319505},
//                {0.000555028,0.000172582,-0.014639137},
//                {-0.000542208,0.001373143,-0.015738185},
//                {0.000679924,0.005865062,-0.01293087},
//                {-0.001762115,0.007293348,-0.01537293},
//                {-0.002123435,0.005550722,-0.015251279},
//                {-0.002849418,0.005523536,-0.013176441},
//                {-0.000156046,0.003300529,-0.012688575},
//                {0.000697899,0.005234616,-0.015740629},
//                {0.00191407,0.008264979,-0.014764369},
//                {0.000807771,0.005919394,-0.013055859},
//                {-0.000295302,0.00468298,-0.012201605},
//                {-0.000416819,0.004554287,-0.012934089},
//                {0.000681935,0.005528549,-0.012934208},
//                {-0.001273266,0.002719764,-0.013300417},
//                {-0.000416982,0.003583504,-0.009516058},
//                {-5.11E-05,0.001517183,-0.011346994},
//                {0.001045394,-0.001757323,-0.010980427},
//                {0.001650216,-0.003556314,-0.01146823},
//                {0.002009578,1.43E-05,-0.011834025},
//                {0.002366766,-0.001433073,-0.010979295},
//                {-0.000328094,-0.004339335,-0.01317638},
//                {3.79E-05,-0.004551457,-0.01110059},
//                {-0.000939913,-0.005494592,-0.012442945},
//                {-0.000327929,-0.005341401,-0.014395535},
//                {-0.002889676,-0.003121241,-0.01573801},
//                {-0.002025209,-0.005544398,-0.010366559},
//                {-0.001524702,-0.006848563,-0.010854183},
//                {0.000313766,-0.004736971,-0.012806712},
//                {-0.000176226,-0.001433874,-0.013783097},
//                {-0.000543125,-0.004247417,-0.011952162},
//                {-0.003347543,-0.003512865,-0.011829972},
//                {-0.001505083,-0.002661473,-0.009999035},
//                {-0.001621875,-0.000962975,-0.011463998},
//                {-0.000153878,-0.001957489,-0.011220038},
//                {0.000333298,0.003515686,-0.010488033},
//                {0.001552565,0.004943227,-0.011587201},
//                {-0.000524983,2.67E-05,-0.01256424},
//                {0.001428964,0.000254976,-0.007315516},
//                {0.000812193,0.004873679,-0.012198687},
//                {0.002882903,0.00471913,-0.013297854},
//                {0.001164243,0.004935556,-0.013420343},
//                {0.001037198,0.006252704,-0.011589766},
//                {0.00103206,0.003784765,-0.014397798},
//                {0.003466238,0.004628335,-0.013787566},
//                {0.000156581,0.00803261,-0.017327964},
//                {-9.16E-05,0.003502627,-0.013421951},
//                {-0.001192322,0.003136417,-0.012567461},
//                {-9.06E-05,0.00362875,-0.013665913},
//                {0.000153868,0.001316117,-0.01574105},
//                {0.001372435,0.001818363,-0.014642179},
//                {-9.69E-05,0.005855481,-0.015862823},
//                {0.000512848,0.001340169,-0.013421474},
//                {-0.001195966,-0.001939915,-0.011956273},
//                {-0.002165657,-0.001426355,-0.011467516},
//                {-0.001178695,-0.001527659,-0.011467218},
//                {0.000657309,-0.000656325,-0.010246277},
//                {-0.002393714,-0.002718036,-0.011833012},
//                {-0.001405617,-0.004160344,-0.0064615},
//                {-0.000662795,-0.004492535,-0.009878872},
//                {0.000807563,-0.003122995,-0.012930155},
//                {-0.001632182,-0.003715932,-0.010854779},
//                {0.000693512,-0.002591521,-0.005971432},
//                {-0.000290478,-0.003775438,-0.010243354},
//                {0.001539821,-0.005333432,-0.009998798},
//                {0.001650684,-0.003470066,-0.014636993},
//                {0.000911646,-0.00224388,-0.015125215},
//                {0.000541054,-0.000294994,-0.015735742},
//                {-0.0001951,0.000791149,-0.013416529},
//                {-0.000929282,-0.002640519,-0.012440205},
//                {0.001510185,-0.002887871,-0.010731338},
//                {0.002356687,0.003329228,-0.014637709},
//                {0.000763812,0.001836793,-0.018788517},
//                {0.000517329,-0.000381196,-0.012075065},
//                {-0.000460968,0.003021652,-0.012075305},
//                {0.002103573,0.002509953,-0.013662577},
//                {-0.000342327,0.004076684,-0.015860137},
//                {-0.00168141,0.004787026,-0.011832118},
//                {-0.003744935,0.004760509,-0.012198687},
//                {0.000787273,0.001809899,-0.009757638},
//                {-0.002508078,0.004241356,-0.017204046},
//                {0.002868528,0.005568911,-0.009635864},
//                {0.000534546,0.004799758,-0.010490954},
//                {4.83E-05,0.00794767,-0.012444554},
//                {-0.001775983,0.006944712,-0.01195663},
//                {-0.000911376,0.000706993,-0.010980129},
//                {-0.006030133,0.0005952,-0.019158598},
//                {-0.001622908,0.004018574,-0.010125279},
//                {-0.002106704,0.002790137,-0.0115903},
//                {-0.00039432,-0.000865286,-0.012200475},
//                {0.003751214,0.00196083,-0.009026408},
//                {0.005197312,-0.000347257,-0.01036912},
//                {-0.00104404,-0.003135138,-0.016228259},
//                {0.000422431,-0.000549394,-0.00768292},
//                {-0.001899409,-0.001387157,-0.010368228},
//                {-6.42E-05,-0.006001154,-0.009147167},
//                {-0.000921928,-0.001447748,-0.010245264},
//                {0.001640453,-0.001308701,-0.00792563},
//                {-0.000566279,-0.002513815,-0.013174534},
//                {0.00150931,-0.000792535,-0.010854959},
//                {-0.000814337,-0.003349533,-0.012563882},
//                {-7.58E-05,-0.007968818,-0.009755908},
//                {-0.000315626,-0.000854104,-0.012318907},
//                {-0.000797906,0.000848845,-0.016713437},
//                {-0.00115773,-0.002576781,-0.017079767},
//                {-0.00298179,-0.00098473,-0.015492737},
//                {-0.004188592,-0.000492368,-0.016957462},
//                {-2.58E-05,0.002071873,-0.014027713},
//                {-0.003196944,0.003040092,-0.016225096},
//                {-0.000502428,0.002907072,-0.011098204},
//                {0.00035383,0.002890595,-0.011830807},
//                {0.00096177,0.00068009,-0.012929738},
//                {-0.002458693,-0.001643104,-0.012563586},
//                {-0.001720155,0.004331457,-0.008657454},
//                {-0.00183978,0.006616374,-0.010611057},
//                {-0.000374917,0.000600375,-0.004874288},
//                {-0.001596403,0.001317269,-0.008048296},
//                {0.002552792,0.00044801,-0.003898203},
//                {-0.001621111,-0.000902684,-0.013053773},
//                {0.000454866,0.005682851,-0.010002075},
//                {-0.000651394,0.002849093,-0.011711478},
//                {0.000809117,-0.002766028,-0.008659661},
//                {0.005191729,0.004092029,-0.010856688},
//                {-0.000443398,0.003239835,-0.021843132},
//                {-7.99E-05,-0.001507885,-0.016716},
//                {-0.004111561,0.001930302,-0.013053654},
//                {-7.90E-05,0.000965838,-0.010367811},
//                {0.001988281,-0.002924682,-0.013053119},
//                {0.0016108,-0.001193558,-0.014639795},
//                {0.002580054,0.000646963,-0.014761744},
//                {0.002815112,-0.001794165,-0.013663113},
//                {0.001220139,-0.003008837,-0.014883757},
//                {-0.0006117,-0.005439936,-0.010244966},
//                {0.000489831,-0.005902614,-0.010000348},
//                {0.000733398,-0.001858248,-0.011709154},
//                {0.000735336,-0.001865065,-0.011709213},
//                {0.000983831,7.64E-05,-0.013906658},
//                {0.001476113,-0.004919522,-0.01427269},
//                {0.002815012,-0.003929307,-0.010854542},
//                {0.002448375,-0.002338511,-0.012563467},
//                {-0.000350302,-0.002092384,-0.014516471},
//                {-0.003014996,-0.00135821,-0.011098443},
//                {-0.003844014,0.003262423,-0.010244131},
//                {-0.001269174,0.00044874,-0.012563467},
//                {-0.00223534,7.33E-05,-0.016469836},
//                {-0.001130599,0.003952865,-0.014150916},
//                {-0.001855055,0.006232357,-0.010733424},
//                {-0.003431022,0.004979336,-0.012687027},
//                {-0.003052238,0.004459054,-0.010124026},
//                {-0.002673205,0.002969192,-0.009269772},
//                {-0.002542279,0.004042063,-0.012321949},
//                {-0.001926501,0.007303895,-0.013299046},
//                {-0.004719367,0.004356585,-0.014519928},
//                {-0.002991098,0.0009381,-0.008660434},
//                {-0.002008501,0.004105381,-0.0111019},
//                {0.003223204,0.003131516,-0.009881198},
//                {0.000411757,0.003263953,-0.013787389},
//                {0.000286821,0.004370232,-0.01073545},
//                {0.000404066,0.003406964,-0.009148417},
//                {0.002588634,-0.001082325,-0.010490835},
//                {0.002211957,-0.000329195,-0.014152706},
//                {0.003540313,-0.0011648,-0.012931705},
//                {0.00194428,0.000919643,-0.014152406},
//                {0.004488769,0.001899166,-0.012443421},
//                {0.002769255,-0.001869446,-0.01464051},
//                {0.00433878,-0.006231763,-0.012442885},
//                {0.003106953,-0.002674868,-0.01390749},
//                {0.001517141,-0.001443458,-0.015860379},
//                {-0.001893495,-0.00459733,-0.016714629},
//                {-0.001518324,-0.004085659,-0.013418257},
//                {-0.002117784,-0.003942143,-0.014150262},
//                {-0.001619586,-0.003314466,-0.013661683},
//                {-0.004406046,-0.001354388,-0.013905644},
//                {-0.004131373,-0.002195782,-0.009876966},
//                {-0.003255316,-0.00413474,-0.011219442},
//                {-0.000560566,-0.003399584,-0.012073874},
//                {-0.000431224,-0.003646382,-0.012073815},
//                {-0.001033776,-0.002194962,-0.011097429},
//                {-0.00127052,0.001803089,-0.009755015},
//                {-0.001385848,0.000679121,-0.009267209},
//                {-0.00040773,-0.002140191,-0.009267269},
//                {0.00056572,-0.001423293,-0.00975585},
//                {0.001047545,0.001114201,-0.011587322},
//                {0.002012085,0.003281511,-0.012076139},
//                {0.00138888,0.002647083,-0.010977983},
//                {0.002710997,0.001776006,-0.009635508},
//                {0.004638359,0.00273761,-0.012077272},
//                {0.003886404,0.005162404,-0.015373647},
//                {-0.000393127,0.00441875,-0.015739977},
//                {-0.001128579,0.006231812,-0.012932716},
//                {-0.001861553,0.005491328,-0.014275609},
//                {0.000816908,0.0034184,-0.016106661},
//                {0.001664466,0.005245522,-0.016228795},
//                {0.003241092,0.008034655,-0.014275968},
//                {0.002141112,0.007782132,-0.017205831},
//                {0.00275062,0.0049746,-0.014398158},
//                {0.001413246,0.002298709,-0.012689052},
//                {-0.000160888,0.000603515,-0.011590062},
//                {0.00143535,0.002317607,-0.010857582},
//                {0.001325231,0.005731747,-0.012200356},
//                {0.002433638,0.000133549,-0.008660018},
//                {0.001717091,-0.003376664,-0.008781493},
//                {0.0053848,-0.000673109,-0.00743848},
//                {0.002595205,-0.001023559,-0.012076735},
//                {0.001272909,-0.004415287,-0.007803857},
//                {-0.001018913,-0.001104129,-0.005362093},
//                {0.000711043,-0.005590656,-0.009145677},
//                {0.001217082,-0.007143949,-0.011098206},
//                {0.000744546,-0.004554748,-0.009510756},
//                {-0.001188278,-0.003313782,-0.008900046},
//                {-0.000926643,-0.004996471,-0.009265661},
//                {-0.002368394,-0.004247653,-0.010608196},
//                {-0.002952279,-0.006179532,-0.008410452},
//                {-0.004025571,-0.008608244,-0.009386597},
//                {-0.005104337,-0.00155471,-0.013415217},
//                {-0.00582007,-0.002196158,-0.014270067},
//                {-0.007025507,-0.006126587,-0.015857339},
//                {-0.007013338,-0.004935426,-0.016834259},
//                {-0.005298198,-0.002286532,-0.018299699},
//                {-0.006757787,-0.001469026,-0.022450622},
//                {-0.005899035,0.001789541,-0.019277334},
//                {-0.00809009,0.003954128,-0.020620584},
//                {-0.005162153,0.001492925,-0.019400179},
//                {-0.007727961,0.004282448,-0.024283346},
//                {-0.006024369,0.007555604,-0.019644976},
//                {-0.003595709,0.009363079,-0.018302619},
//                {-0.000197652,0.012023745,-0.017692801},
//                {-0.001071439,0.009078458,-0.017204821},
//                {0.001464111,0.007225971,-0.009759009},
//                {0.000340664,0.010492262,-0.012323022},
//                {0.003476718,0.012282318,-0.009150147},
//                {0.003074268,0.010302209,-0.010859728},
//                {0.005713602,0.006504395,-0.006587564},
//                {0.006278713,0.006495938,-0.006588042},
//                {0.00903412,0.004668143,-0.006099939},
//                {0.006310502,0.003948206,-0.009029685},
//                {0.006758333,0.002748628,-0.003048062},
//                {0.005140551,0.000952045,-0.003902197},
//                {0.006452271,-0.001198853,-0.005000234},
//                {0.005573056,-0.001757741,-0.008539677},
//                {0.005794048,-0.004505471,-0.00768429},
//                {0.001999781,-0.002742672,-0.010002911},
//                {0.001628372,-0.002690073,-0.007926941},
//                {-0.002754766,-0.00507694,-0.010245323},
//                {-0.002373878,-0.006853611,-0.008535445},
//                {-0.002966536,-0.005106091,-0.011586545},
//                {-0.002096691,-0.004592162,-0.015736401},
//                {-0.004030342,-0.007377489,-0.018543601},
//                {-0.003152765,-0.007354682,-0.01390451},
//                {-0.004346649,-0.007341045,-0.014880775},
//                {-0.002738623,-0.007094052,-0.016345322},
//                {-0.004669918,-0.004541636,-0.020129681},
//                {-0.003673124,-0.004918786,-0.016711771},
//                {-0.004142164,-0.005295785,-0.016833898},
//                {-0.00034991,-0.003967645,-0.01646775},
//                {-0.000710837,-0.003984321,-0.019519806},
//                {0.001849079,-0.002903684,-0.015003502},
//                {0.000990796,0.002679718,-0.01512605},
//                {0.003297083,0.001189695,-0.01378387},
//                {0.001941179,-0.000780437,-0.012929618},
//                {0.000708915,0.000540596,-0.01122099},
//                {0.000817145,0.002098868,-0.009634672},
//                {0.000437639,0.005355276,-0.009635389},
//                {-0.001035684,0.006653923,-0.00878161},
//                {-0.000798161,0.003324852,-0.007561385},
//                {4.88E-05,0.00365595,-0.007561981},
//                {0.002232645,0.007513077,-0.008661389},
//                {-0.001672246,0.004914478,-0.011713684},
//                {-0.00057274,0.003656613,-0.004878341},
//                {-0.001175039,0.007384212,-0.007564663},
//                {0.00053251,0.003462394,-0.011715293},
//                {0.000532336,0.002851603,-0.014278769},
//                {0.001020462,0.006385287,-0.014156818},
//                {4.71E-05,0.006144731,-0.015011249},
//                {0.002119681,0.005422151,-0.012935936},
//                {0.000292234,0.005559521,-0.01440054},
//                {0.001025951,0.00106978,-0.01342356},
//                {0.001878796,0.001458207,-0.014277697},
//                {0.001753757,0.004520923,-0.016596913},
//                {-0.00080925,0.000633622,-0.015986204},
//                {0.001380145,-0.000930677,-0.010981083},
//                {0.000521237,-0.000912461,-0.012689769},
//                {0.001975304,-0.001871262,-0.012811661},
//                {-0.002780346,-0.003560122,-0.014520288},
//                {-0.004109483,-0.002686361,-0.012200594},
//                {-0.005189135,-0.005703701,-0.011223434},
//                {-0.003955853,-0.006883778,-0.010490298},
//                {-0.005646957,-0.004536069,-0.010978041},
//                {-0.003801769,-0.002803724,-0.008414207},
//                {-0.002697642,-0.002905535,-0.010244904},
//                {-0.001720457,-0.003374583,-0.012075603},
//                {-0.001838021,-0.006391826,-0.010610223},
//                {-0.00170704,-0.007557184,-0.00780177},
//                {-0.001583064,-0.002185491,-0.010975538},
//                {-0.00109865,-0.000367084,-0.011586128},
//                {-0.001468472,-0.003665459,-0.010609567},
//                {0.000231393,-0.002575976,-0.009999394},
//                {0.002291402,-0.003565166,-0.010487974},
//                {0.004468743,-0.001879243,-0.011464953},
//                {0.002502101,-0.000199782,-0.011831701},
//                {0.002487576,0.000623669,-0.007071495},
//                {0.003204733,-0.000377121,-0.009025037},
//                {0.004531346,0.001304368,-0.012931881},
//                {0.004882133,0.002374917,-0.014763413},
//                {0.005232917,0.002714125,-0.01439774},
//                {0.003637453,0.006587769,-0.016107142},
//                {0.004236511,0.005949191,-0.014520824},
//                {0.004220403,0.001542931,-0.012079654},
//                {0.005057691,0.005180548,-0.013056636},
//                {0.005900277,0.009059184,-0.017085489},
//                {0.003214854,0.005387691,-0.021113928},
//                {0.001147684,0.006112429,-0.017207742},
//                {0.000794036,0.00891028,-0.015865028},
//                {0.001417404,0.006227944,-0.01635319},
//                {0.000334953,0.008429593,-0.017451644},
//                {-0.000984898,0.009287245,-0.012812911},
//                {-0.004247773,0.005275854,-0.010371087},
//                {-0.00409179,0.004685211,-0.00939405},
//                {-0.00283897,0.005675997,-0.008050859},
//                {-0.002078376,0.002278534,-0.010735989},
//                {-0.005576718,0.0077696,-0.004754304},
//                {-0.012352124,-0.000993036,-0.00524193},
//                {-0.009255053,0.002928274,0.008430421},
//                {-0.007633648,0.008174607,-0.011711119},
//                {-0.010167299,0.003673509,0.018074512},
//                {0.015397757,0.007320357,0.004524052},
//                {-0.00679738,0.006347531,-0.015739381},
//                {-0.018951569,-0.002413183,-0.012442768},
//                {-0.004174974,-0.019661913,-0.008901358},
//                {-0.00610824,-0.00278917,0.000864744},
//                {0.005453764,-0.008604614,-0.006458998},
//                {0.011868243,-0.018300312,-0.007923007},
//                {-0.002424438,-0.00303063,-0.00889951},
//                {0.002301557,-0.007268985,-0.003161848},
//                {0.005552057,-0.016863823,-0.010607541},
//                {0.008068603,-0.000405117,-0.009387491},
//                {0.005836743,0.000416385,-0.010486722},
//                {0.008356327,-0.007538527,-0.005848645},
//                {0.005151047,0.004735185,-0.007436573},
//                {0.007683703,-0.002997959,-0.010611176},
//                {0.010336492,0.000612312,-0.010490119},
//                {0.007632168,0.004946202,-0.016472578},
//                {0.005421279,0.00415708,-0.010980368},
//                {0.002851666,0.004106335,-0.008905945},
//                {0.005164823,0.005038814,-0.012202501},
//                {0.004795896,0.003906228,-0.012691377},
//                {-0.000926058,0.006925681,-0.014522791},
//                {-0.000418964,0.009440376,-0.007321239},
//                {-0.002344533,0.008075885,-0.012814641},
//                {0.000726022,0.007453034,-0.010617433},
//                {-0.00303014,0.005623513,-0.014157355},
//                {-0.002148715,0.009270522,-0.009030461},
//                {-0.004436868,0.010477799,-0.011594057},
//                {-0.003675848,0.007301309,-0.010373175},
//                {-0.007788729,0.00608188,-0.010739265},
//                {-0.006655033,0.00218538,-0.009518206},
//                {-0.005163746,0.002070363,-0.011349021},
//                {-0.004777366,0.002318715,-0.013424097},
//                {-0.00706863,0.001350331,-0.011104524},
//                {-0.004364946,-0.000340309,-0.009272993},
//                {-0.001188075,-0.002873442,-0.011713922},
//                {-0.000947458,-0.006982592,-0.013544381},
//                {-0.00180761,-0.001338265,-0.012689471},
//                {-0.000232963,-0.006662783,-0.011590242},
//                {0.00048375,-0.00576064,-0.012688277},
//                {0.002416952,-0.003764486,-0.014884949},
//                {0.004953733,-0.009324693,-0.013175188},
//                {0.003586511,-0.002331027,-0.013296843},
//                {0.003683783,-0.000230923,-0.014761448},
//                {0.002928019,-0.007029591,-0.011709213},
//                {0.001324081,-0.002861327,-0.011953175},
//                {0.004105162,-0.006135514,-0.01048821},
//                {0.004327832,-0.00953674,-0.012197018},
//                {0.002607533,-0.001378831,-0.014272571},
//                {0.001257976,-0.00298689,-0.010488749},
//                {0.002225145,-0.005557956,-0.005361973},
//                {0.00173555,-0.002775068,-0.011954127},
//                {0.001007822,0.000242417,-0.014273999},
//                {-0.002759661,-0.003441514,-0.012076974},
//                {-0.002738249,-0.002243126,-0.01122272},
//                {-0.002960486,0.003947956,-0.014396964},
//                {0.000225023,0.000629607,-0.013054488},
//                {-0.000738904,-0.002920508,-0.014519334},
//                {0.002074139,0.006323649,-0.014031587},
//                {0.000982823,0.00970615,-0.01732808},
//                {0.00025584,0.004314821,-0.015863478},
//                {-0.000957705,0.005389979,-0.014887214},
//                {-0.002290738,0.006460595,-0.016352415},
//                {-0.002404141,0.004359731,-0.01513207},
//                {-0.004833218,0.00932679,-0.015742898},
//                {-0.00128933,0.01037649,-0.012203574},
//                {5.05E-05,0.002191916,-0.012936175},
//                {0.003453239,0.002801904,-0.012936175},
//                {0.000885389,0.00609591,-0.015988048},
//                {2.77E-05,0.001110287,-0.011837302},
//                {-0.000340821,0.002841231,-0.008663235},
//                {-0.000465418,0.002751084,-0.011348305},
//                {-0.00034646,-0.000254141,-0.011103451},
//                {-0.000591511,-0.001790045,-0.010980606},
//                {-0.00132031,0.002640616,-0.012566924},
//                {-0.000219679,0.000236207,-0.010491133},
//                {-0.000947125,-0.002166475,-0.010002255},
//                {0.001246262,-0.004443435,-0.007804394},
//                {0.002574887,-0.007439696,-0.008658109},
//                {0.00231775,-0.003876559,-0.01146549},
//                {-0.001218134,-0.004355181,-0.013906658},
//                {-0.000847762,-0.006401988,-0.009145439},
//                {-0.001089119,-0.005661456,-0.011830866},
//                {0.003293588,-0.00237562,-0.0139063},
//                {0.002553676,-0.005430141,-0.017202258},
//                {0.011554183,-0.010053073,-0.015371144},
//                {-0.004433325,-0.00200617,-0.024160326},
//                {-0.002723892,0.009193509,-0.01964426}


        });



        RealMatrix eulerX = new Array2DRowRealMatrix(new double [][] {{-0.866965592},
                {-0.867344975},
                {-0.867986798},
                {-0.868116677},
                {-0.867893457},
                {-0.867570758},
                {-0.867391944},
                {-0.867931008},
                {-0.868452489},
                {-0.868219554},
                {-0.868070126},
                {-0.868243515},
                {-0.868511736},
                {-0.868920863},
                {-0.869314253},
                {-0.869440496},
                {-0.869514883},
                {-0.87020731},
                {-0.870866477},
                {-0.870773017},
                {-0.869973898},
                {-0.869368553},
                {-0.869287729},
                {-0.869551241},//
                {-0.869304061},
                {-0.868405104},
//                {-0.867690027},//
//                {-0.867554545},
//                {-0.867552876},
//                {-0.867510259},
//                {-0.867229402},
//                {-0.866400957},//
//                {-0.865948141},
//                {-0.866545498},
//                {-0.866735458},
//                {-0.866261721},//
//                {-0.865700424},
//                {-0.865181804},
//                {-0.865515113},
//                {-0.866452932},
//                {-0.866390944},
//                {-0.866057456},
//                {-0.866551042},
//                {-0.867003381},
//                {-0.867221057},
//                {-0.867727399},
//                {-0.867589951},
//                {-0.867479324},
//                {-0.868347108},
//                {-0.868964016},
//                {-0.869253099},
//                {-0.869484425},
//                {-0.869029045},
//                {-0.868871868},
//                {-0.869743705},
//                {-0.869972587},
//                {-0.869334161},
//                {-0.868910611},
//                {-0.868737876},
//                {-0.868781745},
//                {-0.869113326},
//                {-0.869045079},
//                {-0.868432939},
//                {-0.867817223},
//                {-0.868176281},
//                {-0.86861819},
//                {-0.868439019},
//                {-0.867575228},
//                {-0.866984546},
//                {-0.867004335},
//                {-0.86738807},
//                {-0.867346942},
//                {-0.866784096},
//                {-0.866361618},
//                {-0.866532981},
//                {-0.866763473},
//                {-0.866719723},
//                {-0.866640031},
//                {-0.866496623},
//                {-0.866604805},
//                {-0.867413044},
//                {-0.8679474},
//                {-0.867799819},
//                {-0.867372155},
//                {-0.867513537},
//                {-0.868229032},
//                {-0.869025707},
//                {-0.868997157},
//                {-0.868568599},
//                {-0.868436694},
//                {-0.868878186},
//                {-0.869355083},
//                {-0.869315028},
//                {-0.86928755},
//                {-0.869457185},
//                {-0.869811118},
//                {-0.87047565},
//                {-0.870705426},
//                {-0.870024204}
        });

        RealMatrix eulerY = new Array2DRowRealMatrix(new double [][] {{0.284812808},
                {0.284538209},
                {0.284032375},
                {0.283674508},
                {0.283644706},
                {0.283664763},
                {0.283443332},
                {0.283167303},
                {0.283176512},
                {0.283406287},
                {0.283854246},
                {0.283960968},
                {0.283412337},
                {0.282623202},
                {0.282625616},
                {0.283193558},
                {0.283615321},
                {0.283312261},
                {0.283105493},
                {0.2832537},
                {0.283541948},
                {0.283633173},
                {0.283465385},
                {0.283389926},//
                {0.283438861},
                {0.283398449},
//                {0.283312976},//
//                {0.283223361},
//                {0.282880604},
//                {0.282383561},
//                {0.282674551},
//                {0.28310442},//
//                {0.28312403},
//                {0.282554686},
//                {0.282249242},
//                {0.282173187},//
//                {0.282434314},
//                {0.282609552},
//                {0.282764137},
//                {0.282651514},
//                {0.282458156},
//                {0.282403767},
//                {0.282426178},
//                {0.28204006},
//                {0.28142029},
//                {0.280824482},
//                {0.281094015},
//                {0.281713158},
//                {0.282006234},
//                {0.28172937},
//                {0.281581908},
//                {0.281520784},
//                {0.281563818},
//                {0.281325728},
//                {0.280870497},
//                {0.28063193},
//                {0.280566245},
//                {0.280793995},
//                {0.280983776},
//                {0.28065148},
//                {0.280022621},
//                {0.280083388},
//                {0.280686736},
//                {0.281067103},
//                {0.280680031},
//                {0.280294508},
//                {0.280080378},
//                {0.280069381},
//                {0.280195355},
//                {0.280131489},
//                {0.279987127},
//                {0.280056804},
//                {0.280094117},
//                {0.280362964},
//                {0.280465603},
//                {0.280011952},
//                {0.279291093},
//                {0.27939558},
//                {0.279990137},
//                {0.280492753},
//                {0.280300409},
//                {0.280048192},
//                {0.279841959},
//                {0.27961114},
//                {0.279361486},
//                {0.279260695},
//                {0.27912268},
//                {0.279004544},
//                {0.27891466},
//                {0.278987259},
//                {0.279212773},
//                {0.279290646},
//                {0.279062361},
//                {0.279088557},
//                {0.279083103},
//                {0.278899908},
//                {0.278381705},
//                {0.278158903},
//                {0.277902633}
        });

        RealMatrix eulerZ = new Array2DRowRealMatrix(new double [][] {{-6.124073982},
                {-6.123942852},
                {-6.12383604},
                {-6.123743057},
                {-6.123628139},
                {-6.12349081},
                {-6.123329639},
                {-6.12319231},
                {-6.123130322},
                {-6.123102665},
                {-6.123082161},
                {-6.123067856},
                {-6.123089314},
                {-6.123165131},
                {-6.123251438},
                {-6.12330246},
                {-6.123318672},
                {-6.123353004},
                {-6.12339592},
                {-6.123435974},
                {-6.123426914},
                {-6.123328686},
                {-6.123205662},
                {-6.123147964},//
                {-6.123155594},
                {-6.123202801},
//                {-6.123268127},//
//                {-6.123368263},
//                {-6.12348032},
//                {-6.123526573},
//                {-6.123440742},
//                {-6.123229504},//
//                {-6.123029232},
//                {-6.122907162},
//                {-6.122837543},
//                {-6.122812748},
//                {-6.122821808},
//                {-6.122823238},
//                {-6.122848034},
//                {-6.122935295},
//                {-6.123039246},
//                {-6.123143196},
//                {-6.123257637},
//                {-6.123369217},
//                {-6.123488903},
//                {-6.123538494},
//                {-6.123445034},
//                {-6.123261929},
//                {-6.123088837},
//                {-6.12294054},
//                {-6.122867107},
//                {-6.12288332},
//                {-6.122908115},
//                {-6.122938633},
//                {-6.122996807},
//                {-6.123045921},
//                {-6.123079777},
//                {-6.123105526},
//                {-6.123110294},
//                {-6.123131275},
//                {-6.123206615},
//                {-6.123282909},
//                {-6.123319149},
//                {-6.123333931},
//                {-6.123330593},
//                {-6.12332058},
//                {-6.123314381},
//                {-6.123317242},
//                {-6.123319626},
//                {-6.123332977},
//                {-6.123339653},
//                {-6.123319149},
//                {-6.123272896},
//                {-6.12323904},
//                {-6.123228073},
//                {-6.123217106},
//                {-6.123196125},
//                {-6.123167515},
//                {-6.123120308},
//                {-6.123079777},
//                {-6.123037338},
//                {-6.122971058},
//                {-6.122889519},
//                {-6.122804165},
//                {-6.122747898},
//                {-6.122717857},
//                {-6.122702122},
//                {-6.122721195},
//                {-6.122785568},
//                {-6.12285614},
//                {-6.122908592},
//                {-6.122965813},
//                {-6.123001099},
//                {-6.122978687},
//                {-6.12289238},
//                {-6.122839451},
//                {-6.122869968},
//                {-6.122920513},
//                {-6.122938633}
        });






        // Create Kalman filter instance
        KalmanFilterExample kalmanFilter = new KalmanFilterExample(deltaPx, deltaPy, deltaPxv, deltaPyv, delta_x, delta_y, delta_xv, delta_yv, delta_t, H, C, accelerations, eulerX, eulerY, eulerZ);


        System.out.println(accelerations.getColumn(0).length + " " + eulerY.getColumn(0).length);

        // Update the Kalman filter with each acceleration
       for (int i = 0; i < accelerations.getColumn(0).length - 2; ++i) {
            System.out.println("Filtered state: [" + kalmanFilter.getState()[0] + ", " + kalmanFilter.getState()[1] + "]");
            kalmanFilter.update();
        }

        kalmanFilter.plotResults();


//        System.out.println("ebfcjbneskjfvbjkvg" + accelerations.getColumn(0).length);
    }




    public static RealMatrix loadDataFromFile(String filePath) {
        ArrayList<Double[]> dataList = new ArrayList<>();

        try {
            // Open the file for reading
            BufferedReader reader = new BufferedReader(new FileReader(filePath));

            // Skip the header line
            reader.readLine();

            // Read the remaining lines and parse the data
            String line;
            while ((line = reader.readLine()) != null) {
                // Split the line into values
                String[] values = line.split("\t");

                // Parse each value and add it to the data list
                Double[] rowData = new Double[values.length];
                for (int i = 0; i < values.length; i++) {
                    // Replace ',' with '.' and parse the value as double
                    rowData[i] = Double.parseDouble(values[i].replace(",", "."));
                }
                dataList.add(rowData);
            }

            // Close the reader
            reader.close();
        } catch (IOException e) {
            e.printStackTrace();
        }

        // Convert the list to a 2D array
        double[][] data = new double[dataList.size()][];
        for (int i = 0; i < dataList.size(); i++) {
            Double[] row = dataList.get(i);
            data[i] = new double[row.length];
            for (int j = 0; j < row.length; j++) {
                data[i][j] = row[j];
            }
        }

        // Create the RealMatrix object using the data
        RealMatrix accelerations = new Array2DRowRealMatrix(data);

        // Now you have your RealMatrix object containing the data
        // You can use 'accelerations' for further processing

        return accelerations;
    }
}
